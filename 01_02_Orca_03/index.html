<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" />
<meta name="referrer" content="never">
<meta name="keywords" content="">
<meta name="description" content="欢迎访问[chnclkj]的个人博客">
<meta name="author" content="kveln">
<title>ORCA_03、关于Orca计算频率出现虚频的问题 | chnclkj</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">
<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link
  href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'
  rel='stylesheet' type='text/css'>
<link rel="alternate" type="application/rss+xml" title="ORCA_03、关于Orca计算频率出现虚频的问题 | chnclkj » Feed"
  href="https://chnclkj.github.io/atom.xml">
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.10/build/styles/androidstudio.min.css">
<link href="https://chnclkj.github.io/styles/main.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/850552586/ericamcdn@0.1/css/live2d.css">

<script>hljs.initHighlightingOnLoad();</script>

  <meta property="og:description" content="ORCA_03、关于Orca计算频率出现虚频的问题" />
  <meta property="og:url" content="https://chnclkj.github.io/01_02_Orca_03/" />
  <meta property="og:locale" content="zh-CN" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="chnclkj" />
  <!-- <script src="../assets/styles/scripts/tocScript.js"></script> -->
</head>

<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://chnclkj.github.io">chnclkj</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_About">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Study">学习</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Note">记录</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Star">星星</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Future">Future</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_Unity">Unity</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_Navigation">导航</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_hello-gridea">关于</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1714391557898"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <!-- Page Header -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://chnclkj.github.io">chnclkj</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_About">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Study">学习</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Note">记录</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Star">星星</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/Future">Future</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_Unity">Unity</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_Navigation">导航</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://chnclkj.github.io/00_hello-gridea">关于</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1714391557898"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
<header class="masthead" style="background-image: url('https://chnclkj.github.io/media/images/home-bg.jpg')">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        
          <!-- 没Title为其他页面Header -->
          
            <!-- 没Title并且有headerType为Post：文章Header -->
            <div class="post-heading">
              <span class="tags">
                
                <a href="https://chnclkj.github.io/Study/" class="tag">学习</a>
                
              </span>
              <h1>ORCA_03、关于Orca计算频率出现虚频的问题</h1>
              <span class="meta">
                Posted on
                2023-10-16，4 min read
              </span>
            </div>
          
        
      </div>
    </div>
  </div>
</header>
  <!-- Post Content -->
  <article id="post-content-article">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto post-content-container">
          
          <h1 id="orca_03-关于orca计算频率出现虚频的问题">ORCA_03、关于Orca计算频率出现虚频的问题</h1>
<h2 id="一-先优化再计算freq">一、先优化，再计算freq</h2>
<h4 id="1-首先进行结构优化">1、首先进行结构优化</h4>
<p>  下面是结构优化的输入文件，即“.inp”文件</p>
<pre><code>%pal nprocs 64 end
! wB97X-V AUG-CC-PVDZ TIGHTOPT 
* xyzfile 0 1 0-orca.xyz
</code></pre>
<h4 id="2-使用上一步生成的xyz文件进行频率计算">2、使用上一步生成的“.xyz”文件进行频率计算</h4>
<h5 id="21-优化频率计算">  2.1、 优化+频率计算</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V AUG-CC-PVDZ tightopt NUMFREQ
* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果出现虚频</p>
<pre><code>    -59.77   0.00000000   0.00000000     0.000000     0.000000     0.000000
</code></pre>
<h5 id="22-优化频率计算读取上一步波函数">  2.2、 优化+频率计算+读取上一步波函数</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V AUG-CC-PVDZ tightopt NUMFREQ 
%MOINP &quot;input.gbw&quot;
* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果出现虚频</p>
<pre><code>    -59.77   0.00000000   0.00000000     0.000000     0.000000     0.000000
</code></pre>
<h5 id="23-优化频率计算defgrid3">  2.3、 优化+频率计算+DEFGRID3</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V tightopt NUMFREQ
! DEFGRID3
* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果出现虚频</p>
<pre><code>    -18.06   0.00000000   0.00000000     0.000000     0.000000     0.000000
</code></pre>
<h5 id="24-优化频率计算-弥散函数">  2.4、 优化+频率计算-弥散函数</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V tightopt NUMFREQ
* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果没有虚频出现</p>
<pre><code>$ir_spectrum
63
      0.00   0.00000000   0.00000000     0.000000     0.000000     0.000000
      0.00   0.00000000   0.00000000     0.000000     0.000000     0.000000
      0.00   0.00000000   0.00000000     0.000000     0.000000     0.000000
      0.00   0.00000000   0.00000000     0.000000     0.000000     0.000000
      0.00   0.00000000   0.00000000     0.000000     0.000000     0.000000
      0.00   0.00000000   0.00000000     0.000000     0.000000     0.000000
     19.85   0.00043942   2.22067311    -0.014555    -0.077737    -0.025570
     59.46   0.00001741   0.08800557     0.008541     0.003905    -0.001786
     92.58   0.00055188   2.78898388    -0.038152     0.007395     0.018707
    104.22   0.00036720   1.85567911     0.029372     0.013153    -0.007982
</code></pre>
<h5 id="25-优化频率计算-弥散函数加强scf收敛标准">  2.5、 优化+频率计算-弥散函数+加强SCF收敛标准</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V tightopt NUMFREQ

%SCF
MaxIter     100
DirectResetFreq=1
Thresh      1e-12
TCut        1e-14
end

* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果没有虚频出现</p>
<h5 id="26-优化频率计算-弥散函数加强scf收敛标准verytight">  2.6、 优化+频率计算-弥散函数+加强SCF收敛标准+verytight</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V verytightscf verytightopt NUMFREQ

%SCF
MaxIter     100
DirectResetFreq=1
Thresh      1e-12
TCut        1e-14
end

* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果没有虚频出现</p>
<h5 id="27-优化频率计算-弥散函数加强scf收敛标准verytight">  2.7、 优化+频率计算-弥散函数+加强SCF收敛标准+verytight</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V verytightscf tightopt NUMFREQ

%SCF
Thresh      0
end

* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果没有虚频出现</p>
<h5 id="28-优化频率计算defgrid2">  2.8、 优化+频率计算+DEFGRID2</h5>
<pre><code>%pal nprocs 64 end
! wB97X-V tightopt NUMFREQ
! DEFGRID2
* xyzfile 0 1 0-orca.xyz
</code></pre>
<p>结果没有出现虚频</p>
<h2 id="总结">总结</h2>
<h3 id="1-错误汇总">1、错误汇总</h3>
<p>-tightopt NUMFREQ，参数不够<br>
-是否读取结构优化的波函数对频率计算没有影响<br>
-“! DEFGRIDv3”格子采点的最高精度，对频率计算没有促进作用，反而会拖累频率计算<br>
-弥散函数的使用，会对虚频的产生起到促进作用</p>
<h3 id="2-正确的方法">2、正确的方法</h3>
<p>-“! DEFGRIDv2”格子采点的精度，不会出现虚频；<br>
-使用“verytight”参数，附加给“SCF”和“OPT”<br>
-使用高精度的计算，是为了消除弥散函数所带来的频率产生虚频的问题</p>

          <div class="toc-container"><ul class="markdownIt-TOC">
<li><a href="#orca_03-%E5%85%B3%E4%BA%8Eorca%E8%AE%A1%E7%AE%97%E9%A2%91%E7%8E%87%E5%87%BA%E7%8E%B0%E8%99%9A%E9%A2%91%E7%9A%84%E9%97%AE%E9%A2%98">ORCA_03、关于Orca计算频率出现虚频的问题</a>
<ul>
<li><a href="#%E4%B8%80-%E5%85%88%E4%BC%98%E5%8C%96%E5%86%8D%E8%AE%A1%E7%AE%97freq">一、先优化，再计算freq</a><br>
*
<ul>
<li><a href="#1-%E9%A6%96%E5%85%88%E8%BF%9B%E8%A1%8C%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96">1、首先进行结构优化</a></li>
<li><a href="#2-%E4%BD%BF%E7%94%A8%E4%B8%8A%E4%B8%80%E6%AD%A5%E7%94%9F%E6%88%90%E7%9A%84xyz%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97">2、使用上一步生成的“.xyz”文件进行频率计算</a>
<ul>
<li><a href="#21-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97">  2.1、 优化+频率计算</a></li>
<li><a href="#22-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97%E8%AF%BB%E5%8F%96%E4%B8%8A%E4%B8%80%E6%AD%A5%E6%B3%A2%E5%87%BD%E6%95%B0">  2.2、 优化+频率计算+读取上一步波函数</a></li>
<li><a href="#23-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97defgrid3">  2.3、 优化+频率计算+DEFGRID3</a></li>
<li><a href="#24-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97-%E5%BC%A5%E6%95%A3%E5%87%BD%E6%95%B0">  2.4、 优化+频率计算-弥散函数</a></li>
<li><a href="#25-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97-%E5%BC%A5%E6%95%A3%E5%87%BD%E6%95%B0%E5%8A%A0%E5%BC%BAscf%E6%94%B6%E6%95%9B%E6%A0%87%E5%87%86">  2.5、 优化+频率计算-弥散函数+加强SCF收敛标准</a></li>
<li><a href="#26-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97-%E5%BC%A5%E6%95%A3%E5%87%BD%E6%95%B0%E5%8A%A0%E5%BC%BAscf%E6%94%B6%E6%95%9B%E6%A0%87%E5%87%86verytight">  2.6、 优化+频率计算-弥散函数+加强SCF收敛标准+verytight</a></li>
<li><a href="#27-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97-%E5%BC%A5%E6%95%A3%E5%87%BD%E6%95%B0%E5%8A%A0%E5%BC%BAscf%E6%94%B6%E6%95%9B%E6%A0%87%E5%87%86verytight">  2.7、 优化+频率计算-弥散函数+加强SCF收敛标准+verytight</a></li>
<li><a href="#28-%E4%BC%98%E5%8C%96%E9%A2%91%E7%8E%87%E8%AE%A1%E7%AE%97defgrid2">  2.8、 优化+频率计算+DEFGRID2</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%80%BB%E7%BB%93">总结</a>
<ul>
<li><a href="#1-%E9%94%99%E8%AF%AF%E6%B1%87%E6%80%BB">1、错误汇总</a></li>
<li><a href="#2-%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%96%B9%E6%B3%95">2、正确的方法</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
          
          <hr />
          <p class="next-post">下一篇：
            <a href="https://chnclkj.github.io/01_02_Orca_04/">
              <span class="post-title">
                ORCA_04、错误报告&#34;ORCA finished by error termination in GSTEP&#34;&rarr;
              </span>
            </a>
          </p>
          
          <div class="comment" style="text-align: center;">
            
            <span id="/post//" class="leancloud_visitors"
              data-flag-title="ORCA_03、关于Orca计算频率出现虚频的问题">
              <em class="post-meta-item-text">阅读量 </em>
              <i class="leancloud-visitors-count">loading...</i>
            </span>
            

            
            
            <script src='https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js'></script>

<style>
	div#vcomments{
		width:100%;
		max-width: 1000px;
		padding: 2.5%
	}
</style>


	<div id="vcomments"></div>

<script>
	new Valine({
		el: '#vcomments',
		appId: 'jRokyK6R1fVDHzST5d73ulF6-gzGzoHsz',
		appKey: 'TKWiiX0CUgRRuNd18wOGkdpy',
		avatar: '',
		pageSize: 10,
		recordIp: true,
		placeholder: 'Just Go Go',
		visitor: true,
	});
</script>

            
          </div>
        </div>
      </div>
  </article>
  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            
            
              
            
              
            
              
            
              
            
              
            
              
            
              
              <!-- <li class="list-inline-item">
              <a href="https://chnclkj.github.io/atom.xml" target="_blank">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                </span>
              </a>
              </li> -->
          </ul>
          <p class="copyright text-muted">Copyright &copy;<span>chnclkj</span><br><a href="https://github.com/getgridea/gridea" class="Themeinfo">Powered by Gridea</a></p>
        </div>
      </div>
    </div>
   </footer>
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <!-- <script src="https://chnclkj.github.io/media/scripts/bootstrap.bundle.min.js"></script> -->
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.jsdelivr.net/gh/Alanrk/clean-cdn@1.0/scripts/clean-blog.min.js"></script>
  <!-- <script src="https://chnclkj.github.io/media/scripts/clean-blog.min.js"></script> -->
  <script src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
  <style type="text/css">a.back_to_top{text-decoration:none;position:fixed;bottom:40px;right:30px;background:#f0f0f0;height:40px;width:40px;border-radius:50%;line-height:36px;font-size:18px;text-align:center;transition-duration:.5s;transition-propety:background-color;display:none}a.back_to_top span{color:#888}a.back_to_top:hover{cursor:pointer;background:#dfdfdf}a.back_to_top:hover span{color:#555}@media print,screen and(max-width:580px){.back_to_top{display:none!important}}</style>
<a id="back_to_top" href="#" class="back_to_top">
  <span>▲</span></a>
<script>$(document).ready((function(_this) {
    return function() {
      var bt;
      bt = $('#back_to_top');
      if ($(document).width() > 480) {
        $(window).scroll(function() {
          var st;
          st = $(window).scrollTop();
          if (st > 30) {
            return bt.css('display', 'block')
          } else {
            return bt.css('display', 'none')
          }
        });
        return bt.click(function() {
          $('body,html').animate({
            scrollTop: 0
          },
          800);
          return false
        })
      }
    }
  })(this));</script>
  
  <div id="landlord-parent">
    <div id="landlord">
        <div class="message" style="opacity:0"></div>
        <canvas id="live2d" width="240" height="250" class="live2d"></canvas>
    </div>
</div>

<script type="text/javascript">
    if (/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)) {
        //移动端
        console.log("------ 移动端");
    } else {
        console.log("------ PC端 " + navigator.userAgent);

        addScript("https://cdn.jsdelivr.net/gh/850552586/ericamcdn@0.1/js/live2d.js", () => {
            // 加载完成后再loadlive2d
            loadlive2d("live2d", "https://chnclkj.github.io/media/live2d/assets/tororo.model.json");
        });

        var home_Path = "https://chnclkj.github.io/";
        addScript("https://chnclkj.github.io/media/live2d/js/message.js", () => { });
    }

    // 插入js文件，完成后callback
    function addScript(jsfile, callback) {
        var landlord_parent = document.getElementById("landlord-parent");
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = jsfile;
        landlord_parent.appendChild(script);
        script.onload = script.onreadystatechange = function () {
            if (!this.readyState || this.readyState === "loaded" || this.readyState === "complete") {
                script.onload = script.onreadystatechange = null;
                if (callback && typeof callback == "function") {
                    callback(); //window[callback]();如果传递字符串过来 调用window['函数名']() 调用方法
                }
            }
        };
    }
</script>
  
  <script src="https://chnclkj.github.io/media/scripts/tocScript.js"></script>
</body>

</html>